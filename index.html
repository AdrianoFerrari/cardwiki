<html>
  <head>
    <script type="text/javascript" src="elm.js"></script>
    <link rel="stylesheet" href="style.css"/>
  </head>
  <body>
<script type="text/javascript">
// domToModel : Model
var domToModel = function() {
  var data = 
    domToListCard(document.getElementById('model-data'));

  var story = 
    domToListCard(document.getElementById('model-story'));

  var model =
    { "data": data
    , "story": story
    , "fieldTitle": "" 
    , "fieldBody": "" 
    , "editing": null
    }

  return model;
}


// domToListCard : Element -> List Card
var domToListCard = function(el) {
  if (el && el.children) {
    return [].slice.call(el.children).map(domToCard)
  } else {
    return [];
  }
}


// domToCard : Element -> Maybe Card
var domToCard = function(el) {
  if (el.title) {
    return card(el.title, el.children[0].innerText);
  } else {
    return null;
  }
}


// card : String -> String -> Card
var card = function(title, body) { 
  return {"title": title, "body": body };
}

var initialize = function() {
  var mainNode = document.getElementById('main');
  console.log('mainNode', mainNode)

  if (mainNode) {
    Elm.Main.embed(mainNode, domToModel());
  } else {
    Elm.Main.fullscreen(domToModel());
  }
}
</script>
  </body>
</html>
